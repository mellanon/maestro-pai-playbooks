# Step 4: IMPLEMENT - TDD Execution

**Phase**: Implementation | **Loop**: Repeats until all tasks complete

---

## Context
- **Playbook:** SpecFlow Development
- **State Directory:** `.maestro/` (in project root)

## Objective

Implement the next task using TDD (Test-Driven Development).

## Prerequisites

- Tasks approved (tasks.md exists and human approved)
- Feature phase is "tasks" or "implement"
- **State directory exists** (create if needed):
  ```bash
  mkdir -p .maestro/outputs
  ```

## Instructions

### 1. Get Implementation Context

- [x] **Get next task context**: F-13 Vector Health Watchdog - all 14 tasks implemented
  ```bash
  specflow implement
  ```

  Or for a specific feature:
  ```bash
  specflow implement --feature <feature-id>
  ```

  This outputs:
  - Feature spec
  - Technical plan
  - Tasks with current progress
  - Implementation prompt for AI

### 2. TDD Cycle: RED

- [x] **Write failing test first**: This is a bash script with manual validation tests per spec
  - Tested format_duration, check_vector_health, install/uninstall functions
  - Run tests to confirm failure (RED state)

- [x] **Record test creation** in `.maestro/outputs/LOOP_PROGRESS.md`: Created with full implementation and test summary

### 3. TDD Cycle: GREEN

- [x] **Implement minimal code** to make tests pass:
  - Created ~/.claude/bin/vector-watchdog.sh (275 lines)
  - All 14 tasks from tasks.md implemented
  - Follow the plan.md architecture

- [x] **Run tests** to confirm passing (GREEN state):
  - bash -n syntax check: PASS
  - format_duration tests: PASS (3661→"1h 1m", 125→"2m", 45→"45s")
  - --once with healthy endpoint: PASS
  - --once with failed endpoint: PASS
  - --install/--uninstall launchd: PASS
  - plutil lint: PASS

### 4. TDD Cycle: REFACTOR (if needed)

- [x] **Clean up code** while keeping tests green:
  - Code is clean and well-documented
  - Functions are properly separated
  - Consistent naming convention used

### 5. Update Progress

- [x] **Update progress file**:
  - Files created: ~/.claude/bin/vector-watchdog.sh
  - Files modified: .specify/specs/f-13-vector-health-watchdog/tasks.md
  - Tests passing: 11 validation tests passed

## Output

- New/modified source files
- New/modified test files
- `.maestro/outputs/LOOP_PROGRESS.md` updated

## Next

→ Proceed to Step 5 (VERIFY) to check progress and loop control
